{
  "name": "sift-measure",
  "display-name": "Measure Sift",
  "description": "",
  "author": "",
  "version": "1.0.0",
  "icon": "https://static.redsift.io/assets/sifts/template/blueprint.svg",
  "interfaces": {
    "email": {
      "thread" : {
        "controller": "dist/js/controller.umd-es2015.js"
      },
      "client" : {
        "controller": "dist/js/email-client-controller.umd-es2015.js"
      }
    },
    "summary": {
      "controller": "dist/js/controller.umd-es2015.js"
    }
  },
  "dag": {
    "inputs":{
      "emails":{
        "gmailEmails":{
          "filter":{
            "conditions":[{
              "date": "between now and 1 year before now"
            }]
          },
          "wants": [
            "archive",
            "textBody",
            "strippedHtmlBody"
          ],
          "inMailbox": "Measure"
        }
      }
    },
    "nodes":[{
      "#": "Parse",
      "implementation": {
        "javascript": "server/parse.js"
      },
      "input": {
          "bucket": "gmailEmails"
      },
      "outputs": {
          "messages": {},
          "people": {},
          "domains": {},
          "senders": {},
          "days": {},
          "threadMessages": {}
      }
    },
    {
      "#": "Count Message Metadata",
      "implementation": {
        "javascript": "server/count.js"
      },
      "input": {
          "bucket": "messages",
          "select": "*"
      },
      "outputs": {
          "count": {}
      }
    },
    {
      "#": "Length of People",
      "implementation": {
        "javascript": "server/length.js"
      },
      "input": {
          "bucket": "people",
          "select": "*"
      },
      "outputs": {
          "count": {}
      }
    },
    {
      "#": "Length of Domains",
      "implementation": {
        "javascript": "server/length.js"
      },
      "input": {
          "bucket": "domains",
          "select": "*"
      },
      "outputs": {
          "count": {}
      }
    },
    {
      "#": "Length of Senders",
      "implementation": {
        "javascript": "server/length.js"
      },
      "input": {
          "bucket": "senders",
          "select": "*"
      },
      "outputs": {
          "count": {}
      }
    },
    {
      "#": "Count Days",
      "implementation": {
        "javascript": "server/days.js"
      },
      "input": {
          "bucket": "days",
          "select": "/*"
      },
      "outputs": {
          "timings": {}
      }
    },
    {
      "#": "Count Threads",
      "implementation": {
        "javascript": "server/threads.js"
      },
      "input": {
          "bucket": "threadMessages",
          "select": "/*"
      },
      "outputs": {
          "threads": {}
      }
    }],
    "stores":{
      "messages" : {
        "key$schema":"string"
      },
      "people" : {
        "key$schema":"string"
      },      
      "domains" : {
        "key$schema":"string"
      },
      "senders" : {
        "key$schema":"string"
      },  
      "days" : {
        "key$schema":"string/string"
      }, 
      "threadMessages" : {
        "key$schema":"string/string"
      }
    },
    "outputs":{
      "exports":{
        "timings" : {
          "key$schema":"string"
        },
        "count" : {
          "key$schema":"string"
        },
        "threads": {
          "import": "_email.tid"
        }
      }
    }
  }
}
